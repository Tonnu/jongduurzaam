"use strict";function escapeEmailAddress(a){return a?(a=a.toLowerCase(),a=a.replace(/\./g,",")):!1}var app=angular.module("jongduurzaamApp",["ngCookies","ngResource","ngSanitize","ngRoute","firebase"]).constant("FIREBASE_URL","toonverbeek.firebaseio.com").config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"PetitionCtrl"}).when("/admin/",{templateUrl:"views/admin.html",controller:"LoginCtrl"}).otherwise({redirectTo:"/"})}]);app.controller("PetitionCtrl",["$scope","$location","$anchorScroll","Petition",function(a,b,c,d){a.petition={name:"",email:"",text:""},a.petitions=d.all,a.amountOfPetitions=a.petitions.$getIndex().length,a.submit=function(){""!==a.petition.name&&""!==a.petition.email&&-1!==a.petition.email.indexOf("@")&&-1!==a.petition.email.indexOf(".")&&a.petition.email.length>=5?(0===a.petition.text.length&&(a.petition.text="Ik steun deze petitie!"),a.petition.followup=document.getElementById("check-email").checked?1:-1,d.create(a.petition).then(function(){console.log(a.petitions.count()+" have already signed up."),a.successsful=!0,a.petition={name:"",email:"",text:""},a.amountOfPetitions=a.petitions.$getIndex().length,console.log(d.all.$getIndex().length)})):-1===a.petition.email.indexOf("@")||-1===a.petition.email.indexOf(".")||a.petition.email.length<5?($("#alert-placeholder-success").hide(),$("#alert-placeholder-failure").html("Voer een geldig e-mail adres in."),$("#alert-placeholder-failure").show()):($("#alert-placeholder-success").hide(),$("#alert-placeholder-failure").html("Zowel je naam als e-mail adres zijn vereist."),$("#alert-placeholder-failure").show())},a.init=function(){a.amountOfPetitions=a.petitions.$getIndex().length},a.goToElement=function(a,d){b.hash(d),c()}}]),app.factory("Petition",["$firebase","FIREBASE_URL",function(a,b){var c=new Firebase(b+"/jongduurzaam"),d=a(c),e={all:d,create:function(a){for(var b=d.$getIndex(),c=!1,e=0;e<b.length;e++)if(console.log(d[b[e].email]),d[b[e]].email===a.email){console.log("found email key"+a.email),c=!0;break}return c?($("#alert-placeholder-success").hide(),$("#alert-placeholder-failure").html("Dit e-mail adres is al eens gebruikt om een boodschap te versturen."),$("#alert-placeholder-failure").show(),new Error("Dit e-mail adres staat al geregistreerd in ons systeem!")):($("#alert-placeholder-failure").hide(),$("#alert-placeholder-success").show(),d.$add(a))},"delete":function(a){return d.$remove(a)},find:function(a){return d.$child(a)},update:function(){},count:function(){for(;0===d.$getIndex(););return d.$getIndex().length}};return e}]),app.controller("LoginCtrl",["$scope","$location","$firebaseSimpleLogin","FIREBASE_URL",function(a,b,c,d){var e=new Firebase(d+"/jongduurzaam");a.auth=c(e)}]);